# MiiD Gateway Document Validation Api

![N|Solid](https://miid.bio/wp-content/uploads/2021/06/MiID_ico-100x100.png)

**MiiD Gateway Document Validation** is an API that provides the functionality to connect your platform or system to MiiD Gateway Service 

## Operations

 - [Authorization - Login](#ApiGatewayAutorization)
 - [Get Result By Process Id](#ApiGatewayGetResultByProcessId)
 - [Get Result By External Id Process](#ApiGatewayGetResultByExternalIdProcess)
 - [Validate Doc Person Async Gateway](#ValidateDocPersonAsyncGateway)

**MiiD Gateway Document Validation**  is a commercial Service, to use it contact [info@bytte.com.co](mailto:info@bytte.com.co) for instructions on how to obtain the required resources and access

**MiiD** is a trademark registered by Bytte S.A.S 
 
## Operations:
## <a name="ApiGatewayAutorization"></a>Api Gateway Autorization
To use the API, you must have a valid user assigned by MiiD team!!

Url - Login User - POST
https://servicesdev.miid.bio/Login/LoginUser/

```json
{
    "emailAddress": "MyUseraccess@mymail.bio",
    "password": "MyPassword"
}
```
If user/Password are valid, Api returns similar JSON Response

```json
{
    "tokenType": "Bearer",
    "accessToken": "eyJ0eXAiiJKV1QiLCJhbGc....",
    "successOperation": true
}
```

Use Access Token to call the other services provided by this api

---

## <a name="ApiGatewayGetResultByProcessId"></a>Get Result By Process Id
This operation returns detailed information from a Authentication process

Use Only if Process id was generated by operation **ValidateDocPersonAsyncGateway**

Variables to Send:
* **processId** = Is a unique identifier generated by operation *ValidateDocPersonAsyncGateway*

Response fields:
* **enterpriseClientId** = Is a Identifier provided by MiiD Team. This Identifier is unique by client 
* **id** = MiiD Internal Identifier
* **creationDate** = Creation Date
* **finishDate** = Finish Date
* **personId** = MiiD internal Person Identifier
* **type** = Process Type
* **origin** = Origin Type
* **barcodeMrz** = Barcode/MRZ Base64 From document
* **externalId** = Is a current client Identifier (in the client information system)
* **scoreFingerBarcode** = 0
* **scoreFace** = 0
* **scoreLiveness** = Score Face Liveness
* **scoreOcrBarcode** = Score Match Ocr Vs BarCode
* **scoreAniBarcode** = Score Match Ani Vs BarCode
* **scoreAniOcr** = Score Match Ani Vs Ocr
* **scoreWeigthDocument** = Score Weighted weight greater than configured  
* **scoreBykeeper** = Result ByKeeper Validation (0 - false, 1 true)
* **scoreList** = Score restrictive lists
* **scoreProcess** = General Score

* **Status Values** 
* *0* = Process not executed 
* *1* = Process execute and finish correctly
* *2* = The process runs and does not finish correctly

* **statusFingerBarcode** = Status Match fingerprint captured Vs document fingerprint (0,1,2)
* **statusFace** = 0
* **statusLiveness** = 0
* **statusOcrBarcode** = Status Match Ocr Vs BarCode (0,1,2)
* **statusAniBarcode** = Status Match Ani Vs BarCode (0,1,2)
* **statusAniOcr** = Status Match Ani Vs Ocr (0,1,2)
* **statusWeigthDocument** = Status Weighted weight greater than configured (0,1,2)
* **statusBykeeper** = Status ByKeeper (0,1,2)
* **statusList** =  Status restrictive lists
* **statusProcess** = General Process Status (True = User Authenticated)
* **inProcess** =If True, the process has not finished and you must wait for this flag to change to false 

Url - GetResultByExternalIdProcess - POST
> https://servicesdev.miid.bio/Partner/GetResultByExternalIdProcess/

Example Json
```sh
--header Authorization": Bearer eyJ0eXAi......."
```
Body: 
```json
{
    "externalId": "external unique process id"    
}
```

Response:
```json
{
    "id": "4b011b09-629c-4e4e-a115-480afb73fc41",
    "enterpriseClientId": 42000,
    "personId": "2d5b36c1-aedd-4607-be19-cffa5470e1e6",
    "creationDate": "2023-02-21T12:00:59.4681117-05:00",
    "finishDate": "2023-02-21T12:01:50.1163693-05:00",
    "externalId": "11223344-111123-2047aa",
    "tokenId": "91025",
    "type": "EnrollGatewayHologramas",
    "origin": "ALIADO STANDARD",
    "barcodeMrz": "MDM1NzI5ODEz...",    
    "syncBykeeper": true,
    "statusProcess": true, --> Variable to evaluate
    "statusReturn": "SSUCCESS",
    "inProcess": false,
    "mailProcess": "allan.diaz@bytte.com.co",
    "enrollFinger": 1,
    "enrollFace": 1
} 
```
-------
## <a name="ApiGatewayGetResultByExternalIdProcess"></a>Get Result By External IdProcess
This operation returns detailed information from a Authentication process

Variables to Send:

* **TokenBearer** = Is a Token Value previously generated
* **ExternalId** = Is a External Identificator (client transaction identificator)

Response fields:
 **Same response of operation Get Result By Process Id**

Url - GetResultByExternalIdProcess - POST
> https://servicesdev.miid.bio/Partner/GetResultByProcessId/

Example Json
```sh
--header Authorization": Bearer eyJ0eXAi......."
```
Body: 
```json
{
    "externalId": "external unique process id"    
}
```

Response:
```json
{
    "id": "4b011b09-629c-4e4e-a115-480afb73fc41",
    "enterpriseClientId": 42000,
    "personId": "2d5b36c1-aedd-4607-be19-cffa5470e1e6",
    "creationDate": "2023-02-21T12:00:59.4681117-05:00",
    "finishDate": "2023-02-21T12:01:50.1163693-05:00",
    "externalId": "11223344-111123-2047aa",
    "tokenId": "91025",
    "type": "EnrollGatewayHologramas",
    "origin": "ALIADO STANDARD",
    "barcodeMrz": "MDM1NzI5ODEz...",    
    "syncBykeeper": true,
    "statusProcess": true, --> Variable to evaluate
    "statusReturn": "SSUCCESS",
    "inProcess": false,
    "mailProcess": "allan.diaz@bytte.com.co",
    "enrollFinger": 1,
    "enrollFace": 1
}
 
```
-------
## <a name="ValidateDocPersonAsyncGateway"></a>Validate Doc Person Async Gateway
*This operation is Asynchronic*

*Best Performance!*

This operation process biometric information in backend server

This operation return a unique process Id. this id can be used to get the status of process with operation **GetResultByProcessId**

Url - POST
> https://servicesdev.miid.bio/Partner/ValidateDocPersonAsyncGateway/

Variables to Send:

Body Type
* **Form/Data**

Form Variables


* **BarcodeBase64**: Barcode PDF417/MRZ encoded string
* **EmailAddress** : Email Address from final client
* **ExternalId** : External Identifier From Partner client
* **DocumentBackImage** :  Binary file with a back document capture
* **DocumentFrontImage** :  Binary file with a front document capture
* **EnterpriseClientId** : Enterprise client value provided by MiiD
* **DocumentType** : Document Type
* **DocumentNumber** : Document Number


Or if you are using PKI

* **BarcodeBase64**: Barcode PDF417/MRZ encoded string
* **EmailAddress** : Email Address from final client
* **ExternalId** : External Identifier From Partner client
* **documentbackpki** :  PKI Text
* **documentfrontpki** :  PKI Text
* **EnterpriseClientId** : Enterprise client value provided by MiiD
* **DocumentType** : Document Type
* **DocumentNumber** : Document Number


Response example:
```json
{
    "processId": "9e9de99c-948c-4b40-9b6d-5f1dbb693af8",
    "tokenValid": true,
    "statusProcess": true
}
```

Call Example
```console
curl --location --request POST 'https://servicesdev.miid.bio/Partner/ValidateDocPersonAsyncGateway \
--header 'Authorization: Bearer eyJ0eXAiOiJKV1Qi...' \
--form 'BarcodeBase64="MDIwMTYyOT..."' \
--form 'EmailAddress="allan.diaz@bytte.com.co"' \
--form 'ExternalId="aa-223344-111123-2003"' \
--form 'DocumentBackImage=@"//reversoCO.jpg"' \
--form 'DocumentFrontImage=@"//frenteCO.png"' \
--form 'EnterpriseClientId="4500"' \
--form 'DocumentType="1"' \
--form 'DocumentNumber="80208223
```

---

Call PKI Example
```console
curl --location --request POST 'https://servicesdev.miid.bio/Partner/ValidateDocPersonAsyncGateway \
--header 'Authorization: Bearer eyJ0eXAiOiJKV1Qi...' \
--form 'BarcodeBase64="MDIwMTYyOT..."' \
--form 'EmailAddress="allan.diaz@bytte.com.co"' \
--form 'ExternalId="aa-223344-111123-2003"' \
--form 'documentbackpki="PKI__PKwDEPaEVYojAryISeDJPH1MiVT85xF ..."' \
--form 'documentfrontpki="PKI__orXQ+e3XDuGyCw9pk61vmABrD9ioxq ..."' \
--form 'EnterpriseClientId="4500"' \
--form 'DocumentType="1"' \
--form 'DocumentNumber="80208223
```

---

**Response Information**:


Response – Status 200: User authenticated and enrolled
```json
{
    "processId": "9e9de99c-948c-4b40-9b6d-5f1dbb693af8",
    "tokenValid": true,
    "statusProcess": true
}
```

Response – Status 401:
```json
{
  "Message": "Authorization has been denied for this request."
}
```
----